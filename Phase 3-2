【実装指示 - Phase 3-2: 将棋ロジック実装】

将棋のコアロジックを実装してください。UIは後続フェーズで実装します。

【実装対象】
1. 盤面管理
   - 初期配置の生成
   - 駒の移動・配置
   - 持ち駒の管理

2. 合法手生成
   - 各駒種の移動可能マス計算
   - 駒を取る手の生成
   - 持ち駒を打つ手の生成
   - 王手回避の強制（王手時は回避手のみ合法）

3. 特殊ルール判定
   - 二歩の禁止
   - 行き所のない駒の禁止（1段目の歩・香・桂など）
   - 打ち歩詰めの禁止
   - 成りの強制/選択判定

4. 勝敗判定
   - 王手判定
   - 詰み判定（合法手が0かつ王手されている）
   - 千日手判定（同一局面4回）

【テスト駆動開発】
各機能に対してユニットテストを先に作成し、テストがパスするよう実装すること。

【検証方法】
- 全ユニットテストがパスすること
- 以下のエッジケースが正しく判定されること：
  - 二歩が打てないこと
  - 打ち歩詰めが打てないこと
  - 詰みの局面で詰み判定が出ること